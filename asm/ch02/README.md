# x86 架构
## 总览
本章重点介绍与x86汇编语言相关底层硬件。如果说汇编语言是机器最理想的沟通的工具，那么汇编语言程序员必须熟悉处理器内部架构和功能。我们将讨执行指令时发生在处理器内的基本操作。我们将讨论程序是如何被操作系统加载和执行。示例主板布局将提供对x86硬件环境的基本了解，本章结尾讨论应用程序和操作系统之间的分层输入输出如何工作。

## 2.1 通用概念
本章从程序员的角度描述x86处理器家族的架构以及它的宿主操作系统。

### 2.1.1 基本微机设计
微处理器基本设计图  
![figure 2-1](res/microcomputer.png)

核心处理器（CPU）处理运算和逻辑操作，包含有限的几个存储位置称作寄存器，高频时钟，控制单元，和运算单元。

* 时钟结合其他系统组件同步CPU内部操作
* 控制单元（CU）协调执行机器指令所涉及的步骤和顺序
* 运算逻辑单元（ALU）执行算数运算（加法，减法 ）和逻辑运算（AND，OR， NOT）

CPU通过针脚连接到主板插槽来连接计算机其他部分。程序指令和数据都存储在内存里，只有把指令读取到CPU才可执行，指令可以单个复制到CPU，也可以按组复制到CPU。

总线（bus）是一组并列的电线用来电脑的各个部分传输数据。电脑系统有四种类型总线：数据，输入/输出（I/O），控制，寻址。

* 数据总线在CPU和内存之间传输指令和数据
* 输入/输出总线在CPU和系统输入/输出设备之间传输数据
* 控制总线使用二进制信号同步所有绑定在总线上的设备动作
* 当前正在运行的指令转移CPU和内存之间的数据时，地址总线保存当前指令地址和数据。

时钟（Clock），设计CPU和总线的每个操作由内部时钟以很定脉冲同步。机器指令的基础但与时间称作机器周期（时钟周期）。时钟周期长度是一个完整时钟脉冲所需时间。

![figure 2-2](res/clock.png)

时钟周期时间通过时钟速度的倒数来计算，速度对应到每秒振荡次数。比如每秒振荡十亿次(1 GHZ),每个时钟周期时间对应十亿次分之一秒(1 纳秒).

机器指令需要至少一个时钟周期执行，极少的需要超过50个时钟周期（8088处理器的乘法操作）。指令需要内存访问会导致空的时钟周期称作*等待状态*，因为CPU，系统总线，内存的电路访问速度不同。