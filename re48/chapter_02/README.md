# chpater 02:重要基础

## 2.1 整数数据类型
整数数据类型是一种可以转换为数字的值类型。用作数值，枚举以及布尔值。

### 2.1.1 位
最常见的使用是：0 为 *false* 1 为 *true*。

word 中的一组位称作 *位图(bitmap)* 或 *位域(bitfield)*。

但是bit的读取，对齐很不友好，所以使用 word(int) 来代替布尔值。

在 C/C++ 环境中，0 代表 *false* 其他非零代表 *true*。利用此特性来遍历以零结尾的字符串。

### 2.1.2 Byte
Byte 通常用来存储字符。

标准 ASCll 表，特殊字符说明：

* [0..0x1F] 是控制字符，不可打印，[0x20..0x7E]为可打印
* 0(字符串结尾，在C/C++中为 '\0' )
* 0xA (换行, 在C/C++中为 '\n')
* 0xD (回车，在C/C++中为 '\r')
* 0x20 空格

## 2.2 有符号数值表示
首位表示符号位，其它位表示数值位。有符号值需要对应的操作指令。

## 2.3 整数溢出
超出整数最大或最小范围，整数对应的长度无法表示超出范围的数。

## 2.4 AND
### 2.4.1 检测变量是否可以别 2^n 整除
如果是检测一个数是否被 2^n 整除。正常使用 % 操作符，还有更简单的一种方式。比如 4096 是 0x1000，因此后三位 3 * 4 = 12 低字节被清除。因此 C 代码如下：

```C++
if(value & 0xFFF)
{
    printf("value is not divisible by 0x100 (or 4096)\n");
    printf("by the way, remainder is %d\n", vlaue&0xFFF);
}
else
{
    printf("value is divisible by 0x1000 (or 4096)\n");
}
```

还可以检测奇偶数

```C++
if (value & 1)
    // odd
else
    // even
```
## 2.5 AND 和 OR 作为减法和加法

## 2.6 XOR
### 2.6.1 每天讲话
比如有人说”请买点苹果或香蕉“，意思是要么买苹果，或者这买香蕉，只能买一样。逻辑或则表示都可以。

### 2.6.2 加密
通过异或等式来实现加解密：
> cipter_text = plain_text xor key (plain_text xor key) xor key = plain_text

### 2.6.3 RAID4
假设有几个磁盘(D1, D2, D3)，以及一个奇偶盘 (P)。每个写入奇偶盘的 bit/byte 通过其他三个盘的数据来计算：

> P = D1 xor D2 xor D3

任意一个盘损坏，都可以通过其他三个盘恢复。

### 2.6.4 XOR 交换算法

## 2.7 字节序列
### 2.7.1 大端
0x12345678 在内存里表示如下：

| 内存地址 | 字节值 |
| :------- | :----- |
| +0       | 0x12   |
| +1       | 0x34   |
| +2       | 0x56   |
| +3       | 0x78   |

大端 CPU 包括 Motorola 68k， IBM POWER

### 2.7.2 小端
0x12345678 在内存里表示如下：

| 内存地址 | 字节值 |
| :------- | :----- |
| +0       | 0x78   |
| +1       | 0x56   |
| +2       | 0x34   |
| +3       | 0x12   |

## 2.8 内存
三种主要内存类型：

* 全局内存(静态内存分配)。不用显示分配，全局申明变量/数组将会自动分配内存。这些是全局变量，存储在数据段或常量段。它们长度是固定的，不适合缓存/数组。如果发生缓存溢出，将导致覆盖旁边缓存内容。
* 栈(分配在栈上的内存)。通过在函数里申明局部变量/数组自动分配内存。分配和回收速度快。如果发生溢出，将覆盖栈数据。
* 堆(动态内存分配)，通过 malloc()/free() 或 new/delete 来分配/释放。如果忘记释放，将发生内存泄露。

